<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Morning Routine Sequencing Test</title>
<style>
:root {
  --bg: #f0f5ff;
  --card: #ffffff;
  --accent: #2563eb;
  --muted: #6b7280;
  font-family: "Segoe UI", Roboto, Arial;
}
body { margin: 0; background: linear-gradient(180deg, #eaf2ff 0%, var(--bg) 80%); }
.wrap { max-width: 1000px; margin: 30px auto; padding: 20px; }
.scene { background: var(--card); border-radius: 14px; padding: 22px; box-shadow: 0 8px 30px rgba(0,0,0,0.06); }
.header { text-align: center; margin-bottom: 20px; }

/* üï∞Ô∏è Analog clock with numbers */
.clock {
  width: 150px; height: 150px; border: 6px solid #dbeafe; border-radius: 50%;
  margin: 0 auto; position: relative; background: #fff;
}
.clock::after {
  content: ''; width: 10px; height: 10px; background: #2563eb;
  border-radius: 50%; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
}
.number {
  position: absolute; font-size: 14px; font-weight: bold; color: #1e3a8a;
  left: 50%; top: 50%; transform-origin: center;
}
.hand {
  position: absolute; bottom: 50%; left: 50%; transform-origin: bottom center;
  border-radius: 2px;
}
.hand.hour { width: 6px; height: 40px; background: #1e40af; }
.hand.min { width: 4px; height: 60px; background: #2563eb; }
.hand.sec { width: 2px; height: 70px; background: #60a5fa; }

.title { font-size: 26px; font-weight: 700; margin-top: 12px; }
.purpose-box { background: #eff6ff; border: 1px solid #dbeafe; border-radius: 10px; padding: 12px; margin: 18px auto; font-size: 15px; line-height: 1.6; color: #1e293b; }
.story-box { background: #f9fafb; border: 1px solid #e5e7eb; border-radius: 10px; padding: 16px; margin-bottom: 20px; font-size: 16px; line-height: 1.6; color: #0f172a; }
.scene-body { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px; }
.column { background: #f9fafb; border-radius: 10px; padding: 14px; border: 1px solid #e2e8f0; }
.col-title { font-weight: 700; margin-bottom: 8px; font-size: 16px; }
.item-btn {
  background: #fff; border: 1px solid #d1d5db; border-radius: 8px; padding: 10px 12px;
  margin: 6px 0; width: 100%; text-align: left; font-weight: 600; cursor: pointer;
  display: flex; align-items: center; gap: 10px; transition: background 0.1s, transform 0.1s;
}
.item-btn:hover { background: #eef2ff; transform: translateX(2px); }
.order-box { min-height: 160px; border: 2px dashed #cbd5e1; border-radius: 10px; padding: 10px; }
.order-item {
  background: #fff; border: 1px solid #e2e8f0; border-radius: 8px; padding: 8px 10px; margin: 6px 0;
  display: flex; justify-content: space-between; align-items: center; transition: all 0.2s;
}
.order-item:hover { background: #eff6ff; transform: translateX(3px); }
.order-item span { font-weight: 600; }
.btn { padding: 10px 14px; border: none; border-radius: 10px; font-weight: 700; cursor: pointer; margin-right: 10px; }
.btn.primary { background: var(--accent); color: #fff; }
.btn.secondary { background: #eef4ff; color: var(--accent); }
.results { margin-top: 20px; background: #f9fafb; border: 1px solid #e2e8f0; border-radius: 10px; padding: 12px; }
.score { font-size: 22px; font-weight: 700; color: #1e40af; }
footer { text-align: center; margin-top: 20px; color: var(--muted); font-size: 13px; }
.nav-controls { text-align: center; margin-top: 25px; }
</style>
</head>
<body>
<div class="wrap">
  <div class="scene">
    <div class="header">
      <div class="clock" id="clock"></div>
      <div class="title">Morning Routine Sequencing Test</div>
      <div class="purpose-box">
        <strong>Purpose:</strong> This task measures <b>planning, sequencing, and daily routine memory</b>.  
        Difficulty arranging familiar morning steps or skipping logical actions may reflect early <b>executive dysfunction</b> or <b>temporal disorientation</b>,  
        which are hallmark signs of cognitive decline seen in Alzheimer‚Äôs progression.
      </div>
    </div>

    <div class="story-box">
      The sunlight filters softly through your window. You glance at the clock ‚Äî it‚Äôs <strong>7:42 AM</strong>.  
      The world feels calm and familiar. Choose and arrange your morning actions in the order you would normally follow.
    </div>

    <div class="scene-body">
      <div class="column">
        <div class="col-title">Available Morning Actions</div>
        <div id="items"></div>
      </div>

      <div class="column">
        <div class="col-title">Your Planned Order</div>
        <div class="order-box" id="orderBox">Click actions to add them here in order.</div>
        <div style="margin-top:12px;">
          <button class="btn primary" id="submitBtn">Submit Plan</button>
          <button class="btn secondary" id="clearBtn">Clear All</button>
        </div>
      </div>
    </div>

    <div class="results" id="results" hidden>
      <div class="score" id="scoreText">Score: ‚Äî</div>
      <div id="explanation"></div>
    </div>

    <div class="nav-controls">
      <button class="btn secondary" id="skipBtn">‚è≠ Skip Test</button>
      <button class="btn primary" id="nextBtn" hidden>‚û° Next Test</button>
    </div>

    <footer>All results are processed locally. This test identifies planning and sequencing issues relevant to Alzheimer‚Äôs screening.</footer>
  </div>
</div>

<script>
(function(){
  /* üï∞Ô∏è Build numbered analog clock */
  const clock=document.getElementById('clock');
  for(let i=1;i<=12;i++){
    const num=document.createElement('div');
    num.className='number';
    num.textContent=i;
    const angle=(i/12)*360;
    num.style.transform=`rotate(${angle}deg) translate(60px) rotate(-${angle}deg)`;
    clock.appendChild(num);
  }
  const hour=document.createElement('div');hour.className='hand hour';clock.appendChild(hour);
  const min=document.createElement('div');min.className='hand min';clock.appendChild(min);
  const sec=document.createElement('div');sec.className='hand sec';clock.appendChild(sec);

  function updateClock(){
    const h=7, m=42, s=new Date().getSeconds();
    hour.style.transform=`rotate(${(h%12)*30+m/2}deg)`;
    min.style.transform=`rotate(${m*6}deg)`;
    sec.style.transform=`rotate(${s*6}deg)`;
  }
  setInterval(updateClock,1000);
  updateClock();

  /* Test logic */
  const allActions=[
    {id:"open_curtains",label:"ü™ü Open Curtains"},
    {id:"drink_water",label:"üíß Drink Water"},
    {id:"brush_teeth",label:"ü™• Brush Teeth"},
    {id:"stretch",label:"üßò Do Stretching"},
    {id:"get_dressed",label:"üëï Get Dressed"},
    {id:"make_coffee",label:"‚òï Make Coffee"},
    {id:"check_phone",label:"üì± Check Phone"},
    {id:"read_newspaper",label:"üì∞ Read Newspaper"},
    {id:"go_back_sleep",label:"üò¥ Go Back to Sleep"}
  ];
  // üîÄ Shuffle list
  const shuffled = allActions.sort(()=>Math.random()-0.5);

  const itemsContainer=document.getElementById('items');
  shuffled.forEach(act=>{
    const btn=document.createElement('button');
    btn.className='item-btn';
    btn.dataset.id=act.id;
    btn.textContent=act.label;
    btn.onclick=()=>{if(!selected.includes(act.id)){selected.push(act.id);renderOrder();}};
    itemsContainer.appendChild(btn);
  });

  const orderBox=document.getElementById('orderBox');
  const clearBtn=document.getElementById('clearBtn');
  const submitBtn=document.getElementById('submitBtn');
  const skipBtn=document.getElementById('skipBtn');
  const nextBtn=document.getElementById('nextBtn');
  const results=document.getElementById('results');
  const scoreText=document.getElementById('scoreText');
  const explanation=document.getElementById('explanation');
  const selected=[];
  const start=Date.now();

  const IDEAL=["open_curtains","drink_water","brush_teeth","stretch","get_dressed","make_coffee","check_phone","read_newspaper"];

  function renderOrder(){
    orderBox.innerHTML = selected.map((id,i)=>`
      <div class="order-item">
        <span>${i+1}. ${id.replace('_',' ')}</span>
        <button onclick="removeItem('${id}')" style="background:#fee2e2;color:#991b1b;border:none;padding:4px 8px;border-radius:6px;cursor:pointer;">Remove</button>
      </div>`).join('') || "Click actions to add them here in order.";
  }
  window.removeItem=function(id){
    const idx=selected.indexOf(id);
    if(idx>=0)selected.splice(idx,1);
    renderOrder();
  };

  clearBtn.onclick=()=>{selected.length=0;renderOrder();results.hidden=true;nextBtn.hidden=true;};

  skipBtn.onclick=()=>{if(confirm("Skip this test and move to the next?"))window.location.href="shopping_list_test.html";};

  submitBtn.onclick=()=>{
    if(selected.length<2)return alert("Please select at least two actions.");
    const time=(Date.now()-start)/1000;
    const res=calculateScore(selected,time);
    setTimeout(()=>displayResult(res),600);
  };

  function calculateScore(order,time){
    let base=5, correct=0, misplaced=0, illogical=0, skipped=0;
    const CORE=["open_curtains","drink_water","brush_teeth","get_dressed","make_coffee"];
    order.forEach((id,i)=>{
      if(id==="go_back_sleep"){illogical+=3;return;}
      const ideal=IDEAL.indexOf(id);
      if(ideal===-1)misplaced++;
      else if(Math.abs(ideal-i)<=1)correct++;
      else misplaced++;
    });
    CORE.forEach(c=>{if(!order.includes(c))skipped++;});
    let score=base+correct-misplaced-skipped-illogical;
    if(time>25)score-=1;
    score=Math.max(0,Math.min(10,Math.round(score)));
    return {score,correct,misplaced,skipped,illogical,time};
  }

  function displayResult(r){
    results.hidden=false;nextBtn.hidden=false;
    scoreText.textContent=`Score: ${r.score}/10`;

    let summary="";
    if(r.illogical>=3) summary="‚ùå Some choices were illogical ‚Äî such as going back to sleep or skipping major hygiene steps. This can indicate impaired sequencing awareness or disorientation.";
    else if(r.skipped>=2) summary="‚ö†Ô∏è You skipped multiple essential actions. Forgetting routine steps can reflect mild executive decline often seen in early Alzheimer‚Äôs stages.";
    else if(r.score>=8) summary="‚úÖ Excellent sequencing! Logical and efficient morning order ‚Äî strong executive and temporal organization.";
    else if(r.score>=5) summary="‚ö†Ô∏è Average performance ‚Äî some steps were misplaced or delayed, suggesting occasional hesitation or reduced sequencing fluency.";
    else summary="‚ùå Poor planning sequence ‚Äî actions appear random or inconsistent with daily habits, which may signal temporal confusion.";

    explanation.innerHTML=`
      <p>${summary}</p>
      <ul>
        <li>‚úîÔ∏è Correct steps: <strong>${r.correct}</strong></li>
        <li>‚öôÔ∏è Misplaced: <strong>${r.misplaced}</strong></li>
        <li>üö´ Skipped: <strong>${r.skipped}</strong></li>
        <li>üò¥ Illogical: <strong>${r.illogical}</strong></li>
        <li>‚è±Ô∏è Time: <strong>${r.time.toFixed(1)} sec</strong></li>
      </ul>
      <p><strong>Interpretation:</strong> Consistent sequencing errors or inclusion of illogical steps can suggest early executive decline ‚Äî a key marker in mild cognitive impairment and Alzheimer‚Äôs progression.</p>`;
  }

  nextBtn.onclick=()=>window.location.href="newspaper.html";
})();
</script>
</body>
</html>
